(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[449],{8669:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/my-reviews",function(){return t(1044)}])},2761:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3346:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},5452:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},88:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});let r=(0,t(3759).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},1044:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return f}});var r=t(5893),l=t(7294),a=t(9008),i=t.n(a),n=t(1664),o=t.n(n),c=t(837),d=t(8844),x=t(1163),m=t(88),g=t(2761),h=t(5452);let u=(0,t(3759).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var p=t(3346),y=t(5871);function f(){let{user:e,session:s,loading:t}=(0,c.a)(),{showToast:a,showConfirm:n}=(0,d.l)(),f=(0,x.useRouter)(),[v,w]=(0,l.useState)([]),[j,N]=(0,l.useState)(!0);(0,l.useEffect)(()=>{if(console.log("\uD83D\uDD0D My Reviews useEffect triggered"),console.log("authLoading:",t),console.log("user:",e),console.log("session:",s),console.log("session?.access_token:",s?.access_token),t){console.log("⏳ Auth still loading, waiting..."),N(!0);return}if(!s?.access_token){console.log("❌ No access token found"),console.log("Session object:",JSON.stringify(s,null,2)),N(!1);return}console.log("✅ Access token found, fetching reviews..."),(async()=>{N(!0);try{let e={Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"};console.log("\uD83D\uDCE1 Fetching from:",`${y.CT}/reviews/my-reviews`),console.log("\uD83D\uDCE1 Fetching from:",`${y.CT}/college-reviews/my-reviews`);let[t,r]=await Promise.all([fetch(`${y.CT}/reviews/my-reviews`,{headers:e}),fetch(`${y.CT}/college-reviews/my-reviews`,{headers:e})]);if(console.log("\uD83D\uDCE5 Professor response status:",t.status),console.log("\uD83D\uDCE5 College response status:",r.status),!t.ok&&404!==t.status){let e=await t.text();throw console.error("❌ Professor reviews error:",e),Error("Failed to fetch professor reviews")}if(!r.ok&&404!==r.status){let e=await r.text();throw console.error("❌ College reviews error:",e),Error("Failed to fetch college reviews")}let l=[];if(t.ok){let e=await t.json();console.log("✅ Professor reviews data:",e);let s=(e.reviews||[]).map(e=>({...e,type:"professor"}));console.log("✅ Processed professor reviews:",s.length),l.push(...s)}if(r.ok){let e=await r.json();console.log("✅ College reviews data:",e);let s=(e.reviews||[]).map(e=>({...e,type:"college",overallRating:e.ratings?.overall||0}));console.log("✅ Processed college reviews:",s.length),l.push(...s)}console.log("\uD83D\uDCCA Total reviews combined:",l.length),l.sort((e,s)=>new Date(s.createdAt).getTime()-new Date(e.createdAt).getTime()),console.log("\uD83D\uDCBE Setting reviews state..."),w(l),console.log("✅ Reviews state updated!")}catch(e){console.error("❌ Error fetching reviews:",e),w([])}finally{N(!1)}})()},[e,s,t,f]);let b=async(e,t)=>{n("Are you sure you want to delete this review? This action cannot be undone.",async()=>{try{let r="professor"===t?`${y.CT}/reviews/${e}`:`${y.CT}/college-reviews/${e}`,l=await fetch(r,{method:"DELETE",headers:{Authorization:`Bearer ${s?.access_token}`}});if(l.ok)w(s=>s.filter(s=>s.id!==e)),a("Review deleted successfully","success");else{let e=await l.json();throw Error(e.detail||"Failed to delete review")}}catch(e){console.error("Failed to delete review:",e),a(e instanceof Error?e.message:"Failed to delete review. Please try again.","error")}},"Delete Review")},D=e=>(0,r.jsxs)("div",{className:"flex items-center",children:[[1,2,3,4,5].map(s=>(0,r.jsx)(m.Z,{className:`w-4 h-4 ${s<=e?"text-yellow-400 fill-current":"text-gray-300"}`},s)),(0,r.jsxs)("span",{className:"ml-1 text-sm text-gray-600",children:["(",e,"/5)"]})]}),k=e=>(0,r.jsx)("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${{pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"}[e]}`,children:e.charAt(0).toUpperCase()+e.slice(1)});return j||t?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading your reviews..."})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i(),{children:[(0,r.jsx)("title",{children:"My Reviews - RateMyProf India"}),(0,r.jsx)("meta",{name:"description",content:"View and manage your professor reviews"})]}),(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsxs)(o(),{href:"/",className:"flex items-center text-gray-600 hover:text-gray-800",children:[(0,r.jsx)(g.Z,{className:"w-5 h-5 mr-2"}),"Back to Home"]})}),(0,r.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"My Reviews"})]})})}),(0,r.jsx)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:0===v.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(h.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No reviews yet"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"You haven't submitted any reviews yet. Start by rating your professors!"}),(0,r.jsx)(o(),{href:"/",className:"inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Find Professors to Review"})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Your Reviews (",v.length,")"]})}),v.map(e=>(0,r.jsx)("div",{className:"bg-white rounded-lg shadow border border-gray-200",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full mb-2 ${"professor"===e.type?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"}`,children:"professor"===e.type?"\uD83D\uDC68‍\uD83C\uDFEB Professor Review":"\uD83C\uDFEB College Review"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"professor"===e.type?e.professorName:e.collegeName}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"professor"===e.type?e.professorDepartment:`${e.collegeCity}, ${e.collegeState}`}),(0,r.jsxs)("p",{className:"text-sm text-indigo-600 font-medium",children:[e.courseName," • ","professor"===e.type?`${e.semester} ${e.academicYear}`:`${e.yearOfStudy} (${e.graduationYear})`]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[k(e.status),(0,r.jsx)("div",{className:"flex space-x-2",children:(0,r.jsx)("button",{onClick:()=>b(e.id,e.type),className:"p-1 text-gray-400 hover:text-red-600",title:"Delete Review",children:(0,r.jsx)(u,{className:"w-4 h-4"})})})]})]}),"professor"===e.type?(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Overall"}),D(e.overallRating)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Difficulty"}),D(e.difficultyRating||0)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Clarity"}),D(e.clarityRating||0)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Helpfulness"}),D(e.helpfulnessRating||0)]})]}):(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Overall"}),D(e.ratings?.overall||0)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Food"}),D(e.ratings?.food||0)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Internet"}),D(e.ratings?.internet||0)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Clubs"}),D(e.ratings?.clubs||0)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Opportunities"}),D(e.ratings?.opportunities||0)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Facilities"}),D(e.ratings?.facilities||0)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Teaching"}),D(e.ratings?.teaching||0)]})]}),e.reviewText&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsxs)("p",{className:"text-gray-800 leading-relaxed",children:['"',e.reviewText,'"']})}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:["professor"===e.type&&(0,r.jsxs)(r.Fragment,{children:[null!==e.attendanceMandatory&&(0,r.jsxs)("span",{children:["Attendance: ",e.attendanceMandatory?"Mandatory":"Optional"]}),e.assignmentLoad&&(0,r.jsxs)("span",{children:["Workload: ",e.assignmentLoad.charAt(0).toUpperCase()+e.assignmentLoad.slice(1)]})]}),(0,r.jsxs)("span",{className:"flex items-center",children:[(0,r.jsx)(p.Z,{className:"w-3 h-3 mr-1"}),new Date(e.createdAt).toLocaleDateString()]})]})]})},e.id))]})})]})]})}},9008:function(e,s,t){e.exports=t(3867)},1163:function(e,s,t){e.exports=t(3079)}},function(e){e.O(0,[664,888,774,179],function(){return e(e.s=8669)}),_N_E=e.O()}]);